{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n// import fetch from  \"node-fetch\"\nimport axios from 'axios';\nvar tokenUrl = \"https://api.awhere.com/oauth/token\";\nvar baseApiUrl = process.env.BASE_API_URL;\n\nvar forecastsUrl = function forecastsUrl(lat, lon) {\n  return \"\".concat(baseApiUrl, \"/weather/locations/\").concat(lat, \",\").concat(lon, \"/forecasts\");\n};\n\nvar dailyWeatherUrl = function dailyWeatherUrl(lat, lon) {\n  var date = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n  var result = \"\".concat(baseApiUrl, \"/weather/locations/\").concat(lat, \",\").concat(lon, \"/forecasts\");\n\n  if (date) {\n    result = \"\".concat(result, \"/\").concat(date);\n  }\n\n  return result;\n};\n\nexport var getForecasts = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(lat, lon) {\n    var access_token, url, req, res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return getAccessToken();\n\n          case 2:\n            access_token = _context.sent;\n            url = forecastsUrl(lat, lon);\n            _context.next = 6;\n            return axios.get(url, {\n              headers: {\n                Authorization: \"Bearer \".concat(access_token),\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Access-Control-Allow-Methods\": \"*\",\n                \"Access-Control-Allow-Headers\": \"*\"\n              }\n            });\n\n          case 6:\n            req = _context.sent;\n            _context.next = 9;\n            return req.data;\n\n          case 9:\n            res = _context.sent;\n            console.log(res);\n            return _context.abrupt(\"return\", res.forecasts);\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function getForecasts(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getDailyWeather = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(lat, lon) {\n    var date, formattedDate, access_token, url, req, res;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            date = new Date();\n            formattedDate = date.toISOString().split(\"T\")[0];\n            _context2.next = 4;\n            return getAccessToken();\n\n          case 4:\n            access_token = _context2.sent;\n            url = dailyWeatherUrl(lat, lon, formattedDate);\n            _context2.next = 8;\n            return axios.get(url, {\n              headers: {\n                Authorization: \"Bearer \".concat(access_token),\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Access-Control-Allow-Methods\": \"*\",\n                \"Access-Control-Allow-Headers\": \"*\"\n              }\n            });\n\n          case 8:\n            req = _context2.sent;\n            _context2.next = 11;\n            return req.data;\n\n          case 11:\n            res = _context2.sent;\n            console.log(res);\n            return _context2.abrupt(\"return\", res.forecast[0]);\n\n          case 14:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function getDailyWeather(_x3, _x4) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar getAccessToken = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    var api_key, api_secret, encodedKey, req, res;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            api_key = process.env.AWHERE_KEY;\n            api_secret = process.env.AWHERE_SECRET;\n            encodedKey = Buffer.from(\"\".concat(api_key, \":\").concat(api_secret)).toString(\"base64\");\n            _context3.next = 5;\n            return axios.post(tokenUrl, \"grant_type=client_credentials\", {\n              headers: {\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\n                Authorization: \"Basic \".concat(encodedKey),\n                \"Access-Control-Allow-Methods\": \"*\",\n                \"Access-Control-Allow-Headers\": \"*\"\n              }\n            });\n\n          case 5:\n            req = _context3.sent;\n            console.log(req);\n            _context3.next = 9;\n            return req.data;\n\n          case 9:\n            res = _context3.sent;\n            console.log(res);\n            return _context3.abrupt(\"return\", res.access_token);\n\n          case 12:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function getAccessToken() {\n    return _ref3.apply(this, arguments);\n  };\n}();","map":{"version":3,"sources":["/Users/lioneletaba/Documents/Projets/Perso/argrisults-app/ui/services/index.ts"],"names":["axios","tokenUrl","baseApiUrl","process","env","BASE_API_URL","forecastsUrl","lat","lon","dailyWeatherUrl","date","result","getForecasts","getAccessToken","access_token","url","get","headers","Authorization","req","data","res","console","log","forecasts","getDailyWeather","Date","formattedDate","toISOString","split","forecast","api_key","AWHERE_KEY","api_secret","AWHERE_SECRET","encodedKey","Buffer","from","toString","post"],"mappings":"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","sourcesContent":["// import fetch from  \"node-fetch\"\nimport axios from 'axios'\n\nconst tokenUrl = \"https://api.awhere.com/oauth/token\"\nconst baseApiUrl = process.env.BASE_API_URL\nconst forecastsUrl = (lat, lon) => `${baseApiUrl}/weather/locations/${lat},${lon}/forecasts`\nconst dailyWeatherUrl = (lat, lon, date=\"\") => {\n  let result = `${baseApiUrl}/weather/locations/${lat},${lon}/forecasts`\n  if (date){\n    result = `${result}/${date}`\n  }\n  return result;\n\n}\n\n  \n\n\nexport const getForecasts = async (lat, lon) => {\n  const access_token = await getAccessToken();\n  const url = forecastsUrl(lat, lon);\n  const req = await axios.get(url, {\n    headers: {\n      Authorization: `Bearer ${access_token}`,\n      \"Access-Control-Allow-Origin\": \"*\",\n      \"Access-Control-Allow-Methods\": \"*\",\n      \"Access-Control-Allow-Headers\": \"*\"\n    }\n  })\n  const res = await req.data\n  console.log(res)\n  return res.forecasts\n}\n\n\nexport const getDailyWeather = async (lat, lon) => {\n  let date = new Date();\n  const formattedDate = date.toISOString().split(\"T\")[0];\n  const access_token = await getAccessToken();\n  const url = dailyWeatherUrl(lat, lon, formattedDate);\n  const req = await axios.get(url, {\n    headers: {\n      Authorization: `Bearer ${access_token}`,\n      \"Access-Control-Allow-Origin\": \"*\",\n      \"Access-Control-Allow-Methods\": \"*\",\n      \"Access-Control-Allow-Headers\": \"*\"\n    }\n  })\n  const res = await req.data\n  console.log(res)\n  return res.forecast[0]\n}\n\n\n\n\n\n\nconst getAccessToken = async () => {\n  const api_key = process.env.AWHERE_KEY;\n  const api_secret = process.env.AWHERE_SECRET;\n  const encodedKey = Buffer.from(`${api_key}:${api_secret}`).toString(\"base64\");\n  const req = await axios.post(tokenUrl, \"grant_type=client_credentials\", {\n    headers: {\n      \"Access-Control-Allow-Origin\": \"*\",\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      Authorization: `Basic ${encodedKey}`,\n      \"Access-Control-Allow-Methods\": \"*\",\n      \"Access-Control-Allow-Headers\": \"*\"\n    }\n  })\n  console.log(req)\n  const res  = await req.data\n  console.log(res);\n  return res.access_token\n}"]},"metadata":{},"sourceType":"module"}