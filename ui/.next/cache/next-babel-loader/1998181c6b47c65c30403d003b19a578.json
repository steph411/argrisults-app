{"ast":null,"code":"import fetch from \"node-fetch\";\nconst tokenUrl = \"api.awhere.com/oauth/token\";\nconst baseApiUrl = process.env.BASE_API_URL;\n\nconst forecastsUrl = (lat, lon) => `${baseApiUrl}/weather/locations/${lat},${lon}/forecasts`;\n\nconst dailyWeatherUrl = (lat, lon) => `${baseApiUrl}/weather/locations/${lat},${lon}/observations`;\n\nexport const getForecasts = async (lat, lon) => {\n  const access_token = getAccessToken();\n  const url = forecastsUrl(lat, lon);\n  const req = await fetch(url, {\n    headers: {\n      Authorization: `Bearer ${access_token}`\n    }\n  });\n  const res = await req.json();\n  console.log(res);\n  return res;\n};\nexport const getDailyWeather = async (lat, lon) => {\n  const access_token = getAccessToken();\n  const url = dailyWeatherUrl(lat, lon);\n  const req = await fetch(url, {\n    headers: {\n      Authorization: `Bearer ${access_token}`\n    }\n  });\n  const res = await req.json();\n  console.log(res);\n  return res;\n};\n\nconst getAccessToken = async () => {\n  const api_key = process.env.AWHERE_KEY;\n  const api_secret = process.env.AWHERE_SECRET;\n  const encodedKey = btoa(`${api_key}:${api_secret}`);\n  const req = await fetch(tokenUrl, {\n    method: \"POST\",\n    body: JSON.stringify(\"grant_type=client_credentials\"),\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      Authorization: `Basic ${encodedKey}`\n    }\n  });\n  const res = await req.json();\n  console.log(res);\n  return res.access_token;\n};","map":{"version":3,"sources":["/Users/lioneletaba/Documents/Projets/Perso/argrisults-app/ui/services/index.ts"],"names":["fetch","tokenUrl","baseApiUrl","process","env","BASE_API_URL","forecastsUrl","lat","lon","dailyWeatherUrl","getForecasts","access_token","getAccessToken","url","req","headers","Authorization","res","json","console","log","getDailyWeather","api_key","AWHERE_KEY","api_secret","AWHERE_SECRET","encodedKey","btoa","method","body","JSON","stringify"],"mappings":"AAAA,OAAOA,KAAP,MAAmB,YAAnB;AAGA,MAAMC,QAAQ,GAAG,4BAAjB;AACA,MAAMC,UAAU,GAAGC,OAAO,CAACC,GAAR,CAAYC,YAA/B;;AACA,MAAMC,YAAY,GAAG,CAACC,GAAD,EAAMC,GAAN,KAAe,GAAEN,UAAW,sBAAqBK,GAAI,IAAGC,GAAI,YAAjF;;AACA,MAAMC,eAAe,GAAG,CAACF,GAAD,EAAMC,GAAN,KAAe,GAAEN,UAAW,sBAAqBK,GAAI,IAAGC,GAAI,eAApF;;AAGA,OAAO,MAAME,YAAY,GAAG,OAAOH,GAAP,EAAYC,GAAZ,KAAoB;AAC9C,QAAMG,YAAY,GAAGC,cAAc,EAAnC;AACA,QAAMC,GAAG,GAAGP,YAAY,CAACC,GAAD,EAAMC,GAAN,CAAxB;AACA,QAAMM,GAAG,GAAG,MAAMd,KAAK,CAACa,GAAD,EAAM;AAC3BE,IAAAA,OAAO,EAAE;AACPC,MAAAA,aAAa,EAAG,UAASL,YAAa;AAD/B;AADkB,GAAN,CAAvB;AAKA,QAAMM,GAAG,GAAG,MAAMH,GAAG,CAACI,IAAJ,EAAlB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;AACA,SAAOA,GAAP;AACD,CAXM;AAcP,OAAO,MAAMI,eAAe,GAAG,OAAOd,GAAP,EAAYC,GAAZ,KAAoB;AACjD,QAAMG,YAAY,GAAGC,cAAc,EAAnC;AACA,QAAMC,GAAG,GAAGJ,eAAe,CAACF,GAAD,EAAMC,GAAN,CAA3B;AACA,QAAMM,GAAG,GAAG,MAAMd,KAAK,CAACa,GAAD,EAAM;AAC3BE,IAAAA,OAAO,EAAE;AACPC,MAAAA,aAAa,EAAG,UAASL,YAAa;AAD/B;AADkB,GAAN,CAAvB;AAKA,QAAMM,GAAG,GAAG,MAAMH,GAAG,CAACI,IAAJ,EAAlB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;AACA,SAAOA,GAAP;AACD,CAXM;;AAkBP,MAAML,cAAc,GAAG,YAAY;AACjC,QAAMU,OAAO,GAAGnB,OAAO,CAACC,GAAR,CAAYmB,UAA5B;AACA,QAAMC,UAAU,GAAGrB,OAAO,CAACC,GAAR,CAAYqB,aAA/B;AACA,QAAMC,UAAU,GAAGC,IAAI,CAAE,GAAEL,OAAQ,IAAGE,UAAW,EAA1B,CAAvB;AACA,QAAMV,GAAG,GAAG,MAAMd,KAAK,CAACC,QAAD,EAAW;AAChC2B,IAAAA,MAAM,EAAE,MADwB;AAEhCC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe,+BAAf,CAF0B;AAGhChB,IAAAA,OAAO,EAAE;AACP,sBAAgB,mCADT;AAEPC,MAAAA,aAAa,EAAG,SAAQU,UAAW;AAF5B;AAHuB,GAAX,CAAvB;AAQA,QAAMT,GAAG,GAAI,MAAMH,GAAG,CAACI,IAAJ,EAAnB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;AACA,SAAOA,GAAG,CAACN,YAAX;AACD,CAfD","sourcesContent":["import fetch from  \"node-fetch\"\n\n\nconst tokenUrl = \"api.awhere.com/oauth/token\"\nconst baseApiUrl = process.env.BASE_API_URL\nconst forecastsUrl = (lat, lon) => `${baseApiUrl}/weather/locations/${lat},${lon}/forecasts`\nconst dailyWeatherUrl = (lat, lon) => `${baseApiUrl}/weather/locations/${lat},${lon}/observations`\n\n\nexport const getForecasts = async (lat, lon) => {\n  const access_token = getAccessToken();\n  const url = forecastsUrl(lat, lon);\n  const req = await fetch(url, {\n    headers: {\n      Authorization: `Bearer ${access_token}`\n    }\n  })\n  const res = await req.json()\n  console.log(res)\n  return res\n}\n\n\nexport const getDailyWeather = async (lat, lon) => {\n  const access_token = getAccessToken();\n  const url = dailyWeatherUrl(lat, lon);\n  const req = await fetch(url, {\n    headers: {\n      Authorization: `Bearer ${access_token}`\n    }\n  })\n  const res = await req.json()\n  console.log(res)\n  return res\n}\n\n\n\n\n\n\nconst getAccessToken = async () => {\n  const api_key = process.env.AWHERE_KEY;\n  const api_secret = process.env.AWHERE_SECRET;\n  const encodedKey = btoa(`${api_key}:${api_secret}`)\n  const req = await fetch(tokenUrl, {\n    method: \"POST\",\n    body: JSON.stringify(\"grant_type=client_credentials\"),\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      Authorization: `Basic ${encodedKey}`\n    }\n  })\n  const res  = await req.json()\n  console.log(res);\n  return res.access_token\n}"]},"metadata":{},"sourceType":"module"}